%% NiChrome
% Wire: 
% Diameter:
% Insulation Material: 
% Feeder heights: 49, 38, 30 cm

%depth = [0	0.004	0.008	0.012	0.016	0.02] * 1000;
depth_nic = [0	0.005	0.010	0.015	0.020	0.025] * 1000;

len_nic_49a = [25, 20, 15, 10, 5];
force_nic_49a = [0	0.001478083588	0.001549439348	0.001600407747	0.001559633028	0.001590214067;
0	0.002099898063	0.002405708461	0.002436289501	0.00244648318	0.00252803262;
0	0.004566768603	0.004689092762	0.004729867482	0.004729867482	0.004750254842;
0	0.007135575943	0.008521916412	0.008552497452	0.008654434251	0.008623853211;
0	0.03160040775	0.03180428135	0.03203873598	0.03226299694	0.03226299694];

stiff_nic_49a = [NaN	0.09360073667	0.09811939293	0.1013470045	0.09876491525	0.1007014822;
NaN	0.08510566292	0.0974996915	0.09873909435	0.09915222864	0.1024573029;
NaN	0.1041098401	0.1068984965	0.1078280486	0.1078280486	0.1082928247;
NaN	0.07229850005	0.08634506577	0.08665491649	0.0876877522	0.08737790149;
NaN	0.08004476791	0.08056118577	0.08115506631	0.08172312595	0.08172312595];

len_nic_38a = [25, 20, 15, 10, 5];
force_nic_38a = [0	0.001549439348	0.001569826707	0.001590214067	0.001610601427	0.001610601427;
0	0.00244648318	0.00250764526	0.00255861366	0.00255861366	0.00255861366;
0	0.004159021407	0.004556574924	0.004638124363	0.004638124363	0.004638124363;
0	0.006972477064	0.008939857288	0.009235474006	0.009276248726	0.009276248726;
0	0.03119266055	0.03180428135	0.03190621814	0.03115188583	0.03058103976];

stiff_nic_38a = [NaN	0.09811939293	0.09941043757	0.1007014822	0.1019925269	0.1019925269;
NaN	0.09915222864	0.1016310344	0.1036967058	0.1036967058	0.1036967058;
NaN	0.09481431864	0.103877452	0.1057365563	0.1057365563	0.1057365563;
NaN	0.07064596291	0.09057969221	0.09357491578	0.09398805007	0.09398805007;
NaN	0.0790119322	0.08056118577	0.0808193947	0.07890864863	0.07746267863];

len_nic_38b = [25, 20, 15, 10, 5.5]; %, 4.2];
force_nic_38b = [0	0.001529051988	0.001569826707	0.001610601427	0.001651376147	0.001712538226;
0	0.002171253823	0.002344546381	0.002375127421	0.002395514781	0.00245667686;
0	0.002742099898	0.003679918451	0.00378185525	0.003965341488	0.003975535168;
0	0.007737003058	0.008277268094	0.008521916412	0.008562691131	0.008562691131;
0	0.02609582059	0.02661569827	0.02734964322	0.02785932722	0.02833843017];
%0	0.03527013252	0.0380224261	0.03832823649	0.03944954128	0.03944954128];

stiff_nic_38b = [NaN	0.09682834828	0.09941043757	0.1019925269	0.1045746161	0.1084477501;
NaN	0.08799760292	0.09502088578	0.09626028864	0.09708655721	0.09956536293;
NaN	0.06251238165	0.08389208095	0.08621596131	0.09039894596	0.09063133399;
NaN	0.07839223077	0.08386626006	0.08634506577	0.08675820006	0.08675820006;
NaN	0.07998279777	0.08157620507	0.08382572126	0.08538788528	0.08685631945];
% NaN	0.06303850816	0.06795769811	0.06850427477	0.07050838919	0.07050838919];

len_nic_30a = [25, 20, 14, 10, 5];
force_nic_30a = [0	0.0009174311927	0.00128440367	0.001406727829	0.001386340469	0.001386340469;
0	0.001834862385	0.002181447503	0.002222222222	0.002232415902	0.002283384302;
0	0.004791029562	0.004882772681	0.004872579001	0.004872579001	0.004872579001;
0	0.006839959225	0.007645259939	0.007849133537	0.007910295617	0.007991845056;
0	0.02680937819	0.02884811417	0.02935779817	0.02970438328	0.02976554536];

stiff_nic_30a = [NaN	0.05809700897	0.08133581256	0.08908208042	0.08779103578	0.08779103578;
NaN	0.07436417148	0.0884107372	0.09006327435	0.09047640863	0.09254208006;
NaN	0.09514482607	0.09696674827	0.09676431247	0.09676431247	0.09676431247;
NaN	0.06930327648	0.07746267863	0.07952835006	0.08014805148	0.08097432006;
NaN	0.06790894826	0.07307312684	0.07436417148	0.07524208184	0.0753970072];

len_nic_30b = [25, 20, 15, 10, 5];
force_nic_30b = [0	0.001549439348	0.001559633028	0.001590214067	0.001569826707	0.001559633028;
0	0.001946992864	0.002038735984	0.002069317023	0.002038735984	0.002038735984;
0	0.00351783894	0.00374108053	0.00381243629	0.00381243629	0.00381243629;
0	0.006024464832	0.00744138634	0.00754332314	0.00754332314	0.00754332314;
0	0.02204892966	0.02589194699	0.02599388379	0.02579001019	0.02599388379];

stiff_nic_30b = [NaN	0.09811939293	0.09876491525	0.1007014822	0.09941043757	0.09876491525;
NaN	0.07890864863	0.0826268572	0.08386626006	0.0826268572	0.0826268572;
NaN	0.08019711118	0.08528640917	0.08691312542	0.08691312542	0.08691312542;
NaN	0.06104059076	0.0753970072	0.07642984291	0.07642984291	0.07642984291;
NaN	0.05585059129	0.0655850679	0.06584327683	0.06532685897	0.06584327683];

%%
close all
figure

subplot(1,11, [1, 5])
hold all
plot(depth_nic, force_nic_30a, 'k-^');
plot(depth_nic, force_nic_30b, 'k-^');
plot(depth_nic, force_nic_38a, 'k-s', 'MarkerSize',7);
plot(depth_nic, force_nic_38b, 'k-s', 'MarkerSize',7);
plot(depth_nic, force_nic_49a, 'k-o');
set(gca, 'tickdir', 'out')

subplot(1,11, [6, 7])
hold all
plot(1, force_nic_30b(:, end), 'k^');
plot(2, force_nic_30a(:, end), 'k^');
plot(3, force_nic_38a(:, end), 'ks', 'MarkerSize',7);
plot(4, force_nic_38b(:, end), 'ks', 'MarkerSize',7);
plot(5, force_nic_49a(:, end), 'ko');

u = (force_1a(:, end) + force_3a(:, end) + force_3b(:, end) + force_2a(:, end) + force_2b(:, end))/5;

plot([0.5,  5.5], [u, u], 'k--');

xlim([0.5 5.5])
ylim([0.001, 0.07])
set(gca, 'YScale', 'log')
set(gca, 'tickdir', 'out', 'xtick', [1 2, 3, 4, 5], 'YAxisLocation','right')

subplot(1,11, [8, 11])
hold all
a = 0.15;
as = 2.5 * a;
plot(a * (1:5) + 1 - as, flip(stiff_nic_30b(:, end)), 'k^-');
plot(a * (1:5) + 2 - as, flip(stiff_nic_30a(:, end)), 'k^-');
plot(a * (1:5) + 3 - as, flip(stiff_nic_38a(:, end)), 'ks-', 'MarkerSize',7);
plot(a * (1:5) + 4 - as, flip(stiff_nic_38b(:, end)), 'ks-', 'MarkerSize',7);
plot(a * (1:5) + 5 - as, flip(stiff_nic_49a(:, end)), 'ko-');

mean([stiff_nic_30a(:, end); stiff_nic_30b(:, end)])
mean([stiff_nic_38a(:, end); stiff_nic_38b(:, end)])
mean(stiff_nic_49a(:, end))

xlim([0.5 5.5])
% ylim([0.06, 0.12])
% set(gca, 'YScale', 'log')
set(gca, 'tickdir', 'out', 'xtick', [1 2, 3, 4, 5], 'YAxisLocation','left')

% export_fig('tt-mech.pdf','-pdf','-transparent', gcf)

% %% All stiffnesses pooled and LR
% figure
% hold all
% as = 2.5 * a;
% plot(len_1a, stiff_1a(:, end), 'ko-');
% plot(len_3a, stiff_3a(:, end), 'k^-');
% plot(len_3b, stiff_3b(:, end), 'k^-');
% plot(len_2a, stiff_2a(:, end), 'k*-');
% plot(len_2b, stiff_2b(:, end), 'k*-');
% 
% x = [len_1a, len_3a, len_3b, len_2a, len_2b]';
% y = [stiff_1a(:, end); stiff_1a(:, end); stiff_3b(:, end);stiff_2a(:, end); stiff_2b(:, end)];
% X = [ones(length(x),1) x];
% 
% alpha = 0.05;
% N = length(x);
% beta = X\y;
% yp = X*b;
% plot(x,yp,'k-', 'Linewidth', 3)
% 
% x_min = min(x);
% x_max = max(x);
% n_pts = 100;
% 
% X = x_min:(x_max-x_min)/n_pts:x_max;
% Y = ones(size(X))*beta(1) + beta(2)*X;
% SE_y_cond_x = sum((y - beta(1)*ones(size(y))-beta(2)*x).^2)/(N-2);
% SSX = (N-1)*var(x);
% SE_Y = SE_y_cond_x*(ones(size(X))*(1/N + (mean(x)^2)/SSX) + (X.^2 - 2*mean(x)*X)/SSX);
% Yoff = (2*finv(1-alpha,2,N-2)*SE_Y).^0.5;
% 
% top_int = Y + Yoff;
% bot_int = Y - Yoff;
% 
% plot(X,top_int,'k-','LineWidth',1);
% plot(X,bot_int,'k-','LineWidth',1);
% 
% 
% set(gca, 'tickdir', 'out')
% 
% xlim([0 30])
% set(gca, 'tickdir', 'out', 'YAxisLocation','left')
% 
% export_fig('tt-mech.pdf','-pdf','-transparent', gcf)

%% Tungsten
% Wire: California Fine Wire 99.95% Tungsten with H-ML insulation
% Diameter: 0.0003"
% Insulation Material: Polyimide Resin
% Feeder heights: 49, 38, 30 cm

depth_w = [0	0.005	0.010	0.015	0.020	0.025   0.030   0.035] * 1000;

% len_w_49a = [25, 20, 15, 10, 5];
% 
% force_w_49a = [0	0.0001732925586	0.000254841998	0.0002956167176	0.0003058103976	0.0003058103976	0.0003058103976	0.0003058103976;
% 0	0.0002038735984	0.000499490316	0.0005912334353	0.0006625891947	0.0007135575943	0.0007135575943	0.0007135575943;
% 0	0.0008664627931	0.001121304791	0.00122324159	0.00124362895	0.00125382263	0.00125382263	0.00125382263;
% 0	0.002293577982	0.002650356779	0.002752293578	0.002803261978	0.002813455657	0.002813455657	0.002813455657;
% 0	0.003527013252	0.007359836901	0.008603465851	0.008970438328	0.009398572885	0.009704383282	0.009887869521];
% 
% stiff_w_49a = [NaN	0.01097387947	0.01613805805	0.01872014733	0.01936566966	0.01936566966	0.01936566966	0.01936566966;
% NaN	0.00826268572	0.02024358001	0.02396178859	0.02685372859	0.02891940002	0.02891940002	0.02891940002;
% NaN	0.01975298305	0.02556268395	0.02788656431	0.02835134038	0.02858372841	0.02858372841	0.02858372841;
% NaN	0.02323880359	0.02685372859	0.02788656431	0.02840298216	0.02850626573	0.02850626573	0.02850626573;
% NaN	0.008934028935	0.01864268466	0.02179283359	0.02272238573	0.02380686323	0.02458149002	0.02504626609];

len_w_49a = [25, 20, 15, 10, 4.5];

force_w_49a = [0	0.0002752293578	0.0003465851172	0.000377166157	0.0003975535168	0.0003975535168	0.0003975535168	0.0003975535168;
0	0.0005912334353	0.0006523955148	0.0007237512742	0.0007339449541	0.000744138634	0.000744138634	0.000744138634;
0	0.000244648318	0.001019367992	0.001121304791	0.00122324159	0.00125382263	0.00127420999	0.00127420999;
0	0.001447502548	0.00244648318	0.002650356779	0.002762487258	0.002813455657	0.002915392457	0.002915392457;
0	0.009582059123	0.01410805301	0.01422018349	0.01425076453	0.01427115189	0.01427115189	0.01427115189];

stiff_w_49a = [NaN	0.01742910269	0.02194775894	0.02388432591	0.02517537055	0.02517537055	0.02517537055	0.02517537055;
NaN	0.02396178859	0.0264405943	0.02933253431	0.02974566859	0.03015880288	0.03015880288	0.03015880288;
NaN	0.005577312861	0.02323880359	0.02556268395	0.02788656431	0.02858372841	0.02904850448	0.02904850448;
NaN	0.01466626715	0.02478805716	0.02685372859	0.02798984788	0.02850626573	0.02953910145	0.02953910145;
NaN	0.01966002784	0.02894625375	0.0291763179	0.02923906267	0.02928089252	0.02928089252	0.02928089252];

len_w_38a = [25, 20, 15, 10, 5];

force_w_38a = [0	0.000244648318	0.0003160040775	0.0003058103976	0.0003465851172	0.0003567787971	0.0003669724771	0.0003669724771;
0	0.0004485219164	0.0005198776758	0.0005708460754	0.0005402650357	0.0005402650357	0.0005402650357	0.0005402650357;
0	0.0009174311927	0.0009887869521	0.000998980632	0.001029561672	0.001029561672	0.001029561672	0.001029561672;
0	0.002232415902	0.002385321101	0.00244648318	0.00247706422	0.00247706422	0.00247706422	0.00247706422;
0	0.007737003058	0.008267074414	0.008307849134	0.008358817533	0.008358817533	0.008358817533	0.008358817533];

stiff_w_38a = [NaN	0.01549253573	0.02001119198	0.01936566966	0.02194775894	0.02259328127	0.02323880359	0.02323880359;
NaN	0.01817790858	0.02106984859	0.02313552002	0.02189611716	0.02189611716	0.02189611716	0.02189611716;
NaN	0.01821922201	0.01963627261	0.01983870841	0.02044601581	0.02044601581	0.02044601581	0.02044601581;
NaN	0.02261910216	0.02416835573	0.02478805716	0.02509790787	0.02509790787	0.02509790787	0.02509790787;
NaN	0.01959805769	0.02094074412	0.02104402769	0.02117313216	0.02117313216	0.02117313216	0.02117313216];

len_w_38b = [25, 20, 15, 10, 5];

force_w_38b = [0	0.0002038735984	0.0003465851172	0.0003567787971	0.0003567787971	0.0003567787971	0.0003567787971	0.0003567787971;
0	0.0004485219164	0.0005198776758	0.0005708460754	0.0005402650357	0.0005402650357	0.0005402650357	0.0005402650357;
0	0.0009174311927	0.0009887869521	0.000998980632	0.001029561672	0.001029561672	0.001029561672	0.001029561672;
0	0.002232415902	0.002385321101	0.00244648318	0.00247706422	0.00247706422	0.00247706422	0.00247706422;
0	0.007737003058	0.008267074414	0.008307849134	0.008358817533	0.008358817533	0.008358817533	0.008358817533];

stiff_w_38b = [NaN	0.01291044644	0.02194775894	0.02259328127	0.02259328127	0.02259328127	0.02259328127	0.02259328127;
NaN	0.01817790858	0.02106984859	0.02313552002	0.02189611716	0.02189611716	0.02189611716	0.02189611716;
NaN	0.02091492323	0.02254163948	0.02277402752	0.02347119162	0.02347119162	0.02347119162	0.02347119162;
NaN	0.02261910216	0.02416835573	0.02478805716	0.02509790787	0.02509790787	0.02509790787	0.02509790787;
NaN	0.01959805769	0.02094074412	0.02104402769	0.02117313216	0.02117313216	0.02117313216	0.02117313216];

len_w_30a = [25, 20, 15, 10, 5];

force_w_30a = [0	NaN	NaN	NaN	NaN	NaN	NaN	NaN;
0	NaN	NaN	NaN	NaN	NaN	NaN	NaN;
0	0.000998980632	0.001039755352	0.001049949032	0.001049949032	0.001049949032	0.001049949032	0.001049949032;
0	0.001590214067	0.001855249745	0.001967380224	0.002038735984	0.002089704383	0.002089704383	0.002089704383;
0	0.007278287462	0.00754332314	0.007747196738	0.007849133537	0.007849133537	0.007849133537	0.007849133537];

stiff_w_30a = [NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN;
NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN;
NaN	0.02277402752	0.02370357966	0.0239359677	0.0239359677	0.0239359677	0.0239359677	0.0239359677;
NaN	0.01611223715	0.01879761001	0.0199337293	0.0206567143	0.02117313216	0.02117313216	0.02117313216;
NaN	0.01843611751	0.01910746073	0.01962387859	0.01988208751	0.01988208751	0.01988208751	0.01988208751];

len_w_30b = [25, 20, 15, 10, 5];

force_w_30b = [0	NaN	NaN	NaN	NaN	NaN	NaN	NaN;
0	0.000122324159	0.0005912334353	0.0007135575943	0.0007135575943	0.0007135575943	0.0007135575943	0.0007135575943;
0	0.001019367992	0.001070336391	0.001141692151	0.001141692151	0.001141692151	0.001141692151	0.001141692151;
0	0.0005096839959	0.002181447503	0.002303771662	0.00244648318	0.00244648318	0.00244648318	0.00244648318;
0	0.007033639144	0.007747196738	0.007645259939	0.007645259939	0.007645259939	0.007645259939	0.007645259939];

stiff_w_30b = [NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN;
NaN	0.004957611432	0.02396178859	0.02891940002	0.02891940002	0.02891940002	0.02891940002	0.02891940002;
NaN	0.02323880359	0.02440074377	0.02602746002	0.02602746002	0.02602746002	0.02602746002	0.02602746002;
NaN	0.005164178575	0.0221026843	0.02334208716	0.02478805716	0.02478805716	0.02478805716	0.02478805716;
NaN	0.01781641608	0.01962387859	0.01936566966	0.01936566966	0.01936566966	0.01936566966	0.01936566966];



%%
close all
figure

subplot(1,11, [1, 5])
hold all
plot(depth_w, force_w_49a, 'k-o');
% plot(depth_w, force_w_49b, 'k-o');
plot(depth_w, force_w_38a, 'k-*');
plot(depth_w, force_w_38b, 'k-*');
plot(depth_w, force_w_30a, 'k-^');
plot(depth_w, force_w_30b, 'k-^');
set(gca, 'tickdir', 'out')

subplot(1,11, [6, 7])
hold all
plot(1, force_w_30b(:, end), 'k*');
plot(2, force_w_30a(:, end), 'k*');
plot(3, force_w_38a(:, end), 'k^');
plot(4, force_w_38b(:, end), 'k^');
plot(5, force_w_49a(:, end), 'ko');
% plot(6, force_w_49b(:, end), 'ko');

% u = (force_1a(:, end) + force_3a(:, end) + force_3b(:, end) + force_2a(:, end) + force_2b(:, end))/5;

plot([0.5,  6.5], [u, u], 'k--');

xlim([0.5 6.5])
ylim([0.001, 0.07])
set(gca, 'YScale', 'log')
set(gca, 'tickdir', 'out', 'xtick', [1 2, 3, 4, 5, 6], 'YAxisLocation','right')

subplot(1,11, [8, 11])
hold all
a = 0.15;
as = 2.5 * a;
plot(a * (1:5) + 1 - as, flip(stiff_w_30b(:, end)), 'k*-');
plot(a * (1:5) + 2 - as, flip(stiff_w_30a(:, end)), 'k*-');
plot(a * (1:5) + 3 - as, flip(stiff_w_38a(:, end)), 'k^-');
plot(a * (1:5) + 4 - as, flip(stiff_w_38b(:, end)), 'k^-');
plot(a * (1:5) + 5 - as, flip(stiff_w_49a(:, end)), 'ko-');
% plot(a * (1:5) + 6 - as, flip(stiff_w_49b(:, end)), 'ko-');

nanmean([stiff_w_30a(:, end); stiff_w_30b(:, end)])
mean([stiff_w_38a(:, end); stiff_w_38b(:, end)])
mean(stiff_w_49a(:, end))

xlim([0.5 6.5])
% ylim([0.06, 0.12])
% set(gca, 'YScale', 'log')
set(gca, 'tickdir', 'out', 'xtick', [1 2, 3, 4, 5, 6], 'YAxisLocation','left')

% export_fig('tt-mech.pdf','-pdf','-transparent', gcf)
