depth = [0	0.004	0.008	0.012	0.016	0.02] * 1000;

len_1a = [25, 20, 15, 10, 5];
force_1a = [0	0.001478083588	0.001549439348	0.001600407747	0.001559633028	0.001590214067;
0	0.002099898063	0.002405708461	0.002436289501	0.00244648318	0.00252803262;
0	0.004566768603	0.004689092762	0.004729867482	0.004729867482	0.004750254842;
0	0.007135575943	0.008521916412	0.008552497452	0.008654434251	0.008623853211;
0	0.03160040775	0.03180428135	0.03203873598	0.03226299694	0.03226299694];

stiff_1a = [NaN	0.09360073667	0.09811939293	0.1013470045	0.09876491525	0.1007014822;
NaN	0.08510566292	0.0974996915	0.09873909435	0.09915222864	0.1024573029;
NaN	0.1041098401	0.1068984965	0.1078280486	0.1078280486	0.1082928247;
NaN	0.07229850005	0.08634506577	0.08665491649	0.0876877522	0.08737790149;
NaN	0.08004476791	0.08056118577	0.08115506631	0.08172312595	0.08172312595];

len_2a = [25, 20, 14, 10, 5];
force_2a = [0	0.0009174311927	0.00128440367	0.001406727829	0.001386340469	0.001386340469;
0	0.001834862385	0.002181447503	0.002222222222	0.002232415902	0.002283384302;
0	0.004791029562	0.004882772681	0.004872579001	0.004872579001	0.004872579001;
0	0.006839959225	0.007645259939	0.007849133537	0.007910295617	0.007991845056;
0	0.02680937819	0.02884811417	0.02935779817	0.02970438328	0.02976554536];

stiff_2a = [NaN	0.05809700897	0.08133581256	0.08908208042	0.08779103578	0.08779103578;
NaN	0.07436417148	0.0884107372	0.09006327435	0.09047640863	0.09254208006;
NaN	0.09514482607	0.09696674827	0.09676431247	0.09676431247	0.09676431247;
NaN	0.06930327648	0.07746267863	0.07952835006	0.08014805148	0.08097432006;
NaN	0.06790894826	0.07307312684	0.07436417148	0.07524208184	0.0753970072];

len_2b = [25, 20, 15, 10, 5];
force_2b = [0	0.001549439348	0.001559633028	0.001590214067	0.001569826707	0.001559633028;
0	0.001946992864	0.002038735984	0.002069317023	0.002038735984	0.002038735984;
0	0.00351783894	0.00374108053	0.00381243629	0.00381243629	0.00381243629;
0	0.006024464832	0.00744138634	0.00754332314	0.00754332314	0.00754332314;
0	0.02204892966	0.02589194699	0.02599388379	0.02579001019	0.02599388379];

stiff_2b = [NaN	0.09811939293	0.09876491525	0.1007014822	0.09941043757	0.09876491525;
NaN	0.07890864863	0.0826268572	0.08386626006	0.0826268572	0.0826268572;
NaN	0.08019711118	0.08528640917	0.08691312542	0.08691312542	0.08691312542;
NaN	0.06104059076	0.0753970072	0.07642984291	0.07642984291	0.07642984291;
NaN	0.05585059129	0.0655850679	0.06584327683	0.06532685897	0.06584327683];

len_3a = [25, 20, 15, 10, 5];
force_3a = [0	0.001549439348	0.001569826707	0.001590214067	0.001610601427	0.001610601427;
0	0.00244648318	0.00250764526	0.00255861366	0.00255861366	0.00255861366;
0	0.004159021407	0.004556574924	0.004638124363	0.004638124363	0.004638124363;
0	0.006972477064	0.008939857288	0.009235474006	0.009276248726	0.009276248726;
0	0.03119266055	0.03180428135	0.03190621814	0.03115188583	0.03058103976];

stiff_3a = [NaN	0.09811939293	0.09941043757	0.1007014822	0.1019925269	0.1019925269;
NaN	0.09915222864	0.1016310344	0.1036967058	0.1036967058	0.1036967058;
NaN	0.09481431864	0.103877452	0.1057365563	0.1057365563	0.1057365563;
NaN	0.07064596291	0.09057969221	0.09357491578	0.09398805007	0.09398805007;
NaN	0.0790119322	0.08056118577	0.0808193947	0.07890864863	0.07746267863];

len_3b = [25, 20, 15, 10, 5.5]; %, 4.2];
force_3b = [0	0.001529051988	0.001569826707	0.001610601427	0.001651376147	0.001712538226;
0	0.002171253823	0.002344546381	0.002375127421	0.002395514781	0.00245667686;
0	0.002742099898	0.003679918451	0.00378185525	0.003965341488	0.003975535168;
0	0.007737003058	0.008277268094	0.008521916412	0.008562691131	0.008562691131;
0	0.02609582059	0.02661569827	0.02734964322	0.02785932722	0.02833843017];
%0	0.03527013252	0.0380224261	0.03832823649	0.03944954128	0.03944954128];

stiff_3b = [NaN	0.09682834828	0.09941043757	0.1019925269	0.1045746161	0.1084477501;
NaN	0.08799760292	0.09502088578	0.09626028864	0.09708655721	0.09956536293;
NaN	0.06251238165	0.08389208095	0.08621596131	0.09039894596	0.09063133399;
NaN	0.07839223077	0.08386626006	0.08634506577	0.08675820006	0.08675820006;
NaN	0.07998279777	0.08157620507	0.08382572126	0.08538788528	0.08685631945];
% NaN	0.06303850816	0.06795769811	0.06850427477	0.07050838919	0.07050838919];

%%
close all
figure

subplot(1,11, [1, 5])
hold all
plot(depth, force_1a, 'k-o');
plot(depth, force_2a, 'k-*');
plot(depth, force_2b, 'k-*');
plot(depth, force_3a, 'k-^');
plot(depth, force_3b, 'k-^');
set(gca, 'tickdir', 'out')

subplot(1,11, [6, 7])
hold all
plot(1, force_2b(:, end), 'k*');
plot(2, force_2a(:, end), 'k*');
plot(3, force_3a(:, end), 'k^');
plot(4, force_3b(:, end), 'k^');
plot(5, force_1a(:, end), 'ko');

u = (force_1a(:, end) + force_3a(:, end) + force_3b(:, end) + force_2a(:, end) + force_2b(:, end))/5;

plot([0.5,  5.5], [u, u], 'k--');

xlim([0.5 5.5])
ylim([0.001, 0.07])
set(gca, 'YScale', 'log')
set(gca, 'tickdir', 'out', 'xtick', [1 2, 3, 4, 5], 'YAxisLocation','right')

subplot(1,11, [8, 11])
hold all
a = 0.15;
as = 2.5 * a;
plot(a * (1:5) + 1 - as, flip(stiff_2b(:, end)), 'k*-');
plot(a * (1:5) + 2 - as, flip(stiff_2a(:, end)), 'k*-');
plot(a * (1:5) + 3 - as, flip(stiff_3a(:, end)), 'k^-');
plot(a * (1:5) + 4 - as, flip(stiff_3b(:, end)), 'k^-');
plot(a * (1:5) + 5 - as, flip(stiff_1a(:, end)), 'ko-');

xlim([0.5 5.5])
% ylim([0.06, 0.12])
% set(gca, 'YScale', 'log')
set(gca, 'tickdir', 'out', 'xtick', [1 2, 3, 4, 5], 'YAxisLocation','left')

export_fig('tt-mech.pdf','-pdf','-transparent', gcf)

% %% All stiffnesses pooled and LR
% figure
% hold all
% as = 2.5 * a;
% plot(len_1a, stiff_1a(:, end), 'ko-');
% plot(len_3a, stiff_3a(:, end), 'k^-');
% plot(len_3b, stiff_3b(:, end), 'k^-');
% plot(len_2a, stiff_2a(:, end), 'k*-');
% plot(len_2b, stiff_2b(:, end), 'k*-');
% 
% x = [len_1a, len_3a, len_3b, len_2a, len_2b]';
% y = [stiff_1a(:, end); stiff_1a(:, end); stiff_3b(:, end);stiff_2a(:, end); stiff_2b(:, end)];
% X = [ones(length(x),1) x];
% 
% alpha = 0.05;
% N = length(x);
% beta = X\y;
% yp = X*b;
% plot(x,yp,'k-', 'Linewidth', 3)
% 
% x_min = min(x);
% x_max = max(x);
% n_pts = 100;
% 
% X = x_min:(x_max-x_min)/n_pts:x_max;
% Y = ones(size(X))*beta(1) + beta(2)*X;
% SE_y_cond_x = sum((y - beta(1)*ones(size(y))-beta(2)*x).^2)/(N-2);
% SSX = (N-1)*var(x);
% SE_Y = SE_y_cond_x*(ones(size(X))*(1/N + (mean(x)^2)/SSX) + (X.^2 - 2*mean(x)*X)/SSX);
% Yoff = (2*finv(1-alpha,2,N-2)*SE_Y).^0.5;
% 
% top_int = Y + Yoff;
% bot_int = Y - Yoff;
% 
% plot(X,top_int,'k-','LineWidth',1);
% plot(X,bot_int,'k-','LineWidth',1);
% 
% 
% set(gca, 'tickdir', 'out')
% 
% xlim([0 30])
% set(gca, 'tickdir', 'out', 'YAxisLocation','left')
% 
% export_fig('tt-mech.pdf','-pdf','-transparent', gcf)